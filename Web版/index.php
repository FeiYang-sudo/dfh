<script type="text/javascript">
function del(num){
	
	if(confirm("你确定要删除这条表白吗?"))
	{
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "https://www.deginx.com/love/del.php");
    xhr.setRequestHeader('Content-Type', ' application/x-www-form-urlencoded');
    if(confirm("你确定要举报这条表白吗?"))
    xhr.send("num=" + num+"&fuck=1");
    else
    xhr.send("num=" + num);
    xhr.onreadystatechange = function () {
    if (xhr.readyState == 4 && xhr.status == 200) {	
            if (xhr.responseText == 200) {
                mdui.dialog({
                    title: '删除成功...',
                    content: '合格的管理员就是要狠点！',
                    modal: false
                });
                var box = document.getElementById(num);
box.parentNode.removeChild(box);
            } else {
                mdui.dialog({
                    title: '删除失败...',
                    content: '别急嘛,再试试吧！',
                    modal: false
                });
                mdui.alert(xhr.responseText, '错误信息...(麻烦把这些东西复制给站长哥哥看)');
            }
        }
    }
	}
}
function delself(num){
	if(confirm("你确定要删除这条表白吗?可能错过了一个机会呢!"))
	{
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "https://www.deginx.com/love/delself.php");
    xhr.setRequestHeader('Content-Type', ' application/x-www-form-urlencoded');
    xhr.send("num=" + num);
    xhr.onreadystatechange = function () {
    if (xhr.readyState == 4 && xhr.status == 200) {	
            if (xhr.responseText == 200) {
                mdui.dialog({
                    title: '删除成功...',
                    content: '重新表白吧!会成功的!',
                    modal: false
                });
                var box = document.getElementById(num);
box.parentNode.removeChild(box);
            } else {
                mdui.dialog({
                    title: '删除失败...',
                    content: '别急嘛,再试试吧！',
                    modal: false
                });
                mdui.alert(xhr.responseText, '错误信息...(麻烦把这些东西复制给站长哥哥看)');
            }
        }
    }
	}
}
</script>

<?php
require_once("header.php");
require_once("config.php");
$p = $_GET['p'];
if (empty($p) || $p < "1") 
{
  $p = "1";
}
$mysql = "select * from `TABLES` where `TABLE_NAME`='content';";
$result = mysqli_query($conns,$mysql);
$arr = mysqli_fetch_assoc($result);
$num_all = $arr['TABLE_ROWS'];

if ($num_all <= $px) 
{
  $p_all = 1;
} 
else if ($num_all % $px == 0) 
{
  $p_all = $num_all / $px;
} else 
{
  $p_all = (($num_all - ($num_all % $px)) / $px) + 1;
}

if ($p >= $p_all) 

{
  $p = $p_all;
}
$num = ($p - 1) * $px;
//计算出第几条数据
?>

   
  

<p style="font-weight:500;">
 &emsp;快来表白吧-><a class="mdui-text-color-#FF1493-800" href="add.php" style="color:#FF1493">戳我戳我</a>
</p>
<?php
$comd = "SELECT * FROM emlog_love order by time DESC limit $num,$px;";
$sql = mysqli_query($conn,$comd);
//防止出现空白
//信息
while ($row = mysqli_fetch_object($sql)) {
	$DB = Database::getInstance();
	$userData2 = $DB->once_fetch_array("SELECT * FROM ".DB_PREFIX."user WHERE username = '$row->username'");
  echo("<div id=\"$row->num\" class=\"mdui-card\">");
  //序号
  /*echo("<div style=\"
  padding: 5px 7px 11px 7px;
				width:50px;
                height: 50px;
                background-color:rgba(135, 206, 250, 0.5);
                border-radius:5px;\"><center><a style=\"color:#1E90FF; font-size:50px\">".$row->num."</a></center></div>");*/
                
                
          
  ///////////////////////              
   //管理员删除
   if(isLogin())
   {
   	if($userData['lover']=="1")
	{
   	echo('
   	<div onclick=\'del("'.$row->num.'")\'  style="padding: 5px 7px 11px 7px;top:0px; margin-left:auto;width:50px;height: 50px;background-color:rgba(135, 206, 250, 0.5);border-radius:5p;" >
   	<center><svg t="1584357447208" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2259" width="50" height="50"><path d="M853.333333 998.4H170.666667v-682.666667h68.266666v614.4h546.133334v-614.4h68.266666zM691.2 238.933333h-358.4l49.493333-221.866666h259.413334l49.493333 221.866666z m-273.066667-68.266666h187.733334l-18.773334-85.333334h-150.186666l-18.773334 85.333334z" fill="#d81e06" p-id="2260"></path><path d="M375.466667 409.6h68.266666v409.6h-68.266666zM580.266667 409.6h68.266666v409.6h-68.266666z" fill="#d81e06" p-id="2261"></path><path d="M110.933333 170.666667h802.133334v68.266666h-802.133334z" fill="#d81e06" p-id="2262"></path></svg></center></div>');
	}else if($username==$row->username)
	{
		echo('
   	<div onclick=\'delself("'.$row->num.'")\'  style="padding: 5px 7px 11px 7px;top:0px;margin-left:auto; 	width:50px;height: 50px;background-color:rgba(135, 206, 250, 0.5);border-radius:5p;" >
   	<center><svg t="1584357447208" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2259" width="50" height="50"><path d="M853.333333 998.4H170.666667v-682.666667h68.266666v614.4h546.133334v-614.4h68.266666zM691.2 238.933333h-358.4l49.493333-221.866666h259.413334l49.493333 221.866666z m-273.066667-68.266666h187.733334l-18.773334-85.333334h-150.186666l-18.773334 85.333334z" fill="#d81e06" p-id="2260"></path><path d="M375.466667 409.6h68.266666v409.6h-68.266666zM580.266667 409.6h68.266666v409.6h-68.266666z" fill="#d81e06" p-id="2261"></path><path d="M110.933333 170.666667h802.133334v68.266666h-802.133334z" fill="#d81e06" p-id="2262"></path></svg></center></div>');
	}
   }
   
////////////////////////////////////
   
   
     
   
   
   
  //卡片的标题和副标题
  echo("<div class=\"mdui-card-primary\">");
  echo("<div class=\"mdui-card-primary-title\"><h2 style='color:#7B68EE'>TO:" . $row->to . "</h2></div>");
  echo("<div class=\"mdui-card-primary-subtitle\">" . date("Y-m-d H:i:s",$row->time) ."&emsp;". $row->addr."</div>");
  echo("</div>");
  // 卡片的内容
  echo("<div class=\"mdui-card-content\" style=\"word-break:break-all;\"><h3 style='color:	#008B8B'>「" . htmlspecialchars($row->content) . "」</h3></div>");
  echo("<div style=\"
                background-color:rgba(		255,250,205, 0.5);
                border-radius:5px;vertical-align:middle;float:right;\"><a style='color:#FF6347; font-size:24px;'><svg style=\"vertical-align:middle;\"t=\"1584233160811\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"https://www.w3.org/2000/svg\" p-id=\"12199\" width=\"24\" height=\"24\"><path d=\"M947.66 335.93c-4.06-28.7 9.86-77.16-9.85-101.84-23-28.74-68.23-9.15-98.3-10.23-141.82-5.07-282.09-1-423.86 6.56-64 3.4-127.22 6.59-191.17 10.75-10.25 0.07-20.5 0.25-30.76 0.62-27.18 1-63.72-2.75-83.54 19.89-25.52 29.16-24.33 92-27.53 128.3-5.91 67-14.76 134.08-18.07 201.28-1.9 38.63 1.24 75 4.33 113.19 1.52 18.89-1.76 43.55 5.8 61.53 13.13 31.25 40.3 35.46 70.65 37.1 66.85 3.62 131.19 2.81 198.16 1.25 137-3.19 274.24 3.33 411-7.64 26.41-2.12 52.61-5.72 78.95-8.41 24.06-2.46 58.55 4.3 80.7-7.73 28.58-15.52 30.6-54.44 34.42-83.53 15.28-115.94 15.41-245.45-0.93-361.09z m-771-46.12c29.79-2.46 59.83-4.38 89.54-7.74 39.21-4.44 78.19-5.78 117.25-7.5 12.39-0.09 24.78-0.16 37.16-0.57 27.55-0.92 54.47-4 81.26-7.65 104.62-8 213.49-11.45 317-5.2 14.88 0.9 41.1-3.39 56.64-0.59-18 33-50.87 59.27-76.13 86.73a1254 1254 0 0 1-96.47 93.54c-23.94 21-49.54 47.81-76.57 70.35a4.48 4.48 0 0 0-3.7 2.94C608 526 593 536.69 577.6 544.27c-35.13 17.29-47.26 13.81-78.77-3.69-4.6-2.56-9.15-5.28-13.75-7.87a4.09 4.09 0 0 0-0.11-5.41c-6.78-7.71 3.19-23.78 6.93-30.84 4.26-8 9.48-15.69 13.1-24.05 1.8-4.14-4.22-7.81-6.17-3.61-6.38 13.8-30.23 40.6-23.5 58.33-12.31-7-24.64-13.92-36.88-21.11a3.41 3.41 0 0 0 0.8-3.29c-4.88-19.34 16.93-41.42 25.72-57 2.07-3.66-3.56-6.95-5.63-3.29-9.26 16.43-31.34 38.77-27.61 59.56-12.79-7.58-25.59-15.13-38.21-23 1.93-28.4 24.65-49.19 38.08-73.13 1.86-3.31-3.18-6.26-5.09-3-12.38 21.13-38.81 44.53-41.34 70.79-9.35-5.9-18.68-11.83-27.9-17.92-2.89-14.76 11.45-37 17.33-47.72 7.7-14.1 16.94-27.41 24.24-41.71 2-3.84-3.79-7.24-5.81-3.4-10.56 20.07-24.13 38.38-34 58.87-3.66 7.57-9.05 18.2-10.18 28.16-10.81-7.26-21.64-14.5-32.2-22.08 7.18-26.55 24.24-50.17 35.41-75.06 1.48-3.3-3.36-6.21-4.92-2.87-11.52 24.72-28 47.71-36.29 73.66-16.77-12.18-33.25-24.72-49.22-37.85-28.79-23.66-60.35-46.34-87.37-71.93-6.94-6.57-13-14.36-19.42-21.52 12.16-1.13 26.16-2.85 21.82-2.49z m590.11 461.83c-51.09 4.61-102.27 6.67-153.49 7.65 4.21-14.52 18.12-30.38 25.64-42.79 9.1-15 18.65-29.09 19.35-47.15 0.2-5.13-7.76-5.12-8 0-0.86 21-16.55 41-27.46 58.22-6.62 10.44-16.76 19.48-19 31.91-60.32 1-120.69 0.57-181 0.84 9.37-12.07 14.77-26.42 23.28-39.2 11.75-17.65 27.66-32 39-50 2.42-3.85-3.65-7.36-6.08-3.55-10.36 16.25-24.31 29.19-36 44.34-11.51 14.89-17.86 32.82-30.38 47a4.71 4.71 0 0 0-0.87 1.48c-7.18 0-14.36 0.06-21.53 0.13-32.73 0.33-65.48 2.25-98.2 3.54 22.91-29 38.58-63.19 60.13-93.2 2.26-3.15-2.94-6.13-5.18-3-22.84 31.55-41.9 65.45-65.34 96.6-26.45 0.91-52.89 1.26-79.28-0.2-27.93-1.55-53.32 3-71.93-10.47 28.36-20.17 54.94-48.41 78-67.84 28-23.56 57.18-45.58 84.93-69.45 26.64-22.92 49.16-51 79-69.88 21-13.26 2.76-42.59-19.12-32.71-23.48 10.6-37.85 28.15-55.21 46.8-23.88 25.64-50.8 48.36-76.82 71.79-22.54 20.29-44 41.34-65.67 62.57-11.55 11.33-25.37 27.25-39.88 41.22a80.79 80.79 0 0 1-3.58-7.68C106.88 715.75 105 698 104.3 680a3.87 3.87 0 0 0 1.78 0.46l5-0.19c4.58-0.17 5.14-5.57 2.13-7.62C134 636.34 162 605.11 187 571.75c2.38-3.17-3.08-7.43-5.53-4.26-26.3 34-55.75 65.7-77.37 103.06-0.25-14.68 0.06-29-0.12-40.23-0.43-25.72 0.85-51.44 2.79-77.13a3.91 3.91 0 0 0 1-1.12c11.51-18.86 26-35.41 39.12-53.07 14-18.79 25.64-38.58 45-52.6 2.71-2 0.15-6.52-2.66-4.56-16.68 11.62-28 26.82-39.94 43-13.36 18.16-28.36 35-41.34 53.4 2.09-24.32 4.62-48.63 7-72.9 18.39-28.61 39.53-55.38 64.7-78.46 3.21-2.94-1.53-7.61-4.76-4.76a383.66 383.66 0 0 0-58.16 65c0.77-8.2 1.5-16.41 2.15-24.6 2.53-31.85-0.23-72.77 10-102.9a66.77 66.77 0 0 1 9.36-18.23c9.07 12 18.94 27 23.87 32.56 13.85 15.5 31.48 28.78 46.47 43.39 32.22 31.4 63.6 62.84 99.79 89.81 41.66 31.05 85.92 60.27 129.89 88 27.37 17.24 60.64 45 93.08 49.18 41.21 5.31 86.13-23.31 126.49-57.42 12.18 13.64 23.17 29.65 33.39 40.63 24.81 26.66 48.61 54.22 74 80.28 17.56 18 43.56 54.75 70.71 75.86-22.93 3.08-46 5.86-69.16 7.96z m147-270.7c-2.51 62.86-0.73 127-6.59 189.62-2.78 29.69-3.62 45.56-11.07 55.09-1.79-4.29-5.25-8.18-11-11-21.61-10.45-41.66-33.83-59.31-49.46q-42.66-37.77-85.7-75.13c-18.49-16.13-41-40.43-65.38-57.92 26.79-24.18 50.84-49.09 69.42-65.46 39.43-34.75 74.89-72.46 110.54-111 17.7-19.12 34.9-34.1 48.89-52.67-0.11 0.88-0.23 1.76-0.35 2.63 9.73 57.36 12.92 117.09 10.59 175.29z\" fill=\"#d4237a\" p-id=\"12200\"></path><path d=\"M194.78 482.44a465.08 465.08 0 0 1-41.25 73.91c-7.16 10.51-15.16 20.45-21.65 31.4-5.42 9.14-13.4 33.83-22.82 38.4-4.65 2.25-0.59 9 4 6.88 7.51-3.42 10.26-6.67 13.94-13.81 7.58-14.74 11.53-29.06 21.12-43.17 19.73-29 37.5-58.52 51.47-90.79 1.41-3.26-3.35-6.12-4.81-2.82zM241.91 659.9c-15.57 9-24.53 27.82-36.09 41-9.84 11.23-25.35 25.29-25.76 41.29-0.13 5.09 7.24 4.85 7.76 0 1.69-15.61 18-28.9 27.28-40.41 9.58-11.83 16.79-28.19 30.11-36.27 3.58-2.15 0.35-7.72-3.3-5.61zM280.9 674.55c-9.28 14.31-20.71 27.09-29.82 41.5-7.86 12.44-12 26.82-23.88 36.29-4.45 3.56 1.82 9.63 6.22 6.22 11.3-8.76 14.81-21.61 21.1-33.89 8.63-16.82 21-31.44 31.2-47.31 1.95-3.03-2.87-5.81-4.82-2.81zM400.41 674.71c-13 27.65-27.44 54.38-46.86 78.11a3.71 3.71 0 1 0 5.85 4.52c18.88-24.56 32.88-51.85 45.3-80.12 1.3-2.88-2.92-5.43-4.29-2.51zM530.36 668.8c-0.63-2.53-4.45-1.46-3.89 1.07 3.57 16.31-24.11 37.83-34.06 49.94-8 9.68-21 22.23-20.62 35.64 0.11 3.89 6.4 5.15 7.12 1 3-17.47 19.39-35.65 30.72-49 9.31-11.01 24.8-22.45 20.73-38.65zM603.73 668.67c-0.74-3.19-5.55-1.83-4.89 1.35 3.14 15.05-16.56 29.72-24.33 41.2C565 725.26 557 740 545.36 752.53c-3.65 3.92 2.4 9.88 5.85 5.86 14.11-16.44 22-36.79 35.42-53.63 8.74-10.98 20.62-20.76 17.1-36.09zM703.84 675c-6.78 28.15-40.54 43-40.6 73.82 0 5.61 8.11 5.43 8.59 0 2.57-29.13 32.8-44.06 38.9-71.92 0.97-4.46-5.81-6.37-6.89-1.9zM764.8 688c-6 8.83-12.1 24-24.4 24.88a2.85 2.85 0 0 0 0 5.69c15.12 1 22.1-17.61 28.6-28.12 1.67-2.7-2.45-5.02-4.2-2.45z\" fill=\"#d4237a\" p-id=\"12201\"></path></svg> " . $row->from . "  </a></div>");
               // <img width=\"30\" heigh=\"30\" style=\"vertical-align:middle; border-radius:7px;\"src=\"".$userData2['photo']."\"  alt=\"".$userData2['username']."\" />
  echo("</div>");
  echo("<br/>");
}
$p_next = $p + 1;
$p_last = $p - 1;
//计算一下上一页或者下一页的num
echo "<br /><center>";
if ($p != 1) {
  echo  "<a href=\"./?p=$p_last\" class=\"mdui-btn mdui-btn-dense mdui-color-theme-accent mdui-ripple\">上一页</a>";
}
echo "&emsp;";
if ($p != $p_all) {
  echo "<a href=\"./?p=$p_next\" class=\"mdui-btn mdui-btn-dense mdui-color-theme-accent mdui-ripple\">下一页</a>";
}
echo "</center><br />";




require_once('footer.php');
?>
 